<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>GPT 学术助手登录</title>
<style>
body{font-family:sans-serif;background:#f2f2f2;height:100vh;display:flex;align-items:center;justify-content:center;}
form{background:white;padding:2rem;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.1);min-width:260px;}
label{display:block;margin-top:1rem;}
input{margin-top:.5rem;padding:.4rem .6rem;width:100%;box-sizing:border-box;}
button{margin-top:1.5rem;padding:.4rem .6rem;width:100%;}
#error{color:red;margin-top:1rem;}
</style>
</head>
<body>
<form id="login-form" method="post">
  <h1>登录 GPT 学术助手</h1>
  <label>邮箱
    <input name="useremail" type="email" required>
  </label>
  <label>密码
    <input name="password" type="password" required>
  </label>
  <input type="hidden" name="next" id="next-input">
  <button type="submit">登录</button>
  <div id="error"></div>
</form>
<script>
const params=new URLSearchParams(location.search);
const next=params.get('next')||'/llms';
document.getElementById('next-input').value=next;
document.getElementById('login-form').addEventListener('submit',async(e)=>{
  e.preventDefault();
  const fd=new FormData(e.target);
  const resp=await fetch('/llms/login',{method:'POST',body:fd});
  const data=await resp.json();
  if(resp.ok){location.href=data.next;}else{document.getElementById('error').textContent=data.error||'登录失败';}
});
</script>
</body>
</html>
